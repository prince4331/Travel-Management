"use strict";exports.id=166,exports.ids=[166],exports.modules={5677:(e,s,a)=>{a.d(s,{Z:()=>t});/**
 * @license lucide-react v0.435.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(1462).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4672:(e,s,a)=>{a.d(s,{Z:()=>t});/**
 * @license lucide-react v0.435.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(1462).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},1166:(e,s,a)=>{a.a(e,async(e,t)=>{try{a.r(s),a.d(s,{default:()=>j});var l=a(997),i=a(6689),r=a(4672),n=a(759),d=a(5677),c=a(3552),o=a(9967),x=a(8154),m=a(2417),h=a(1064),u=a(1027),p=e([m,h,u]);function j({onLocationSelect:e}){let[s,a]=(0,i.useState)(""),[t,p]=(0,i.useState)(!1),[j,g]=(0,i.useState)([]),[w,b]=(0,i.useState)([]),[f,N]=(0,i.useState)(10),[v,y]=(0,i.useState)(!1),S=async()=>{if(s.trim()){p(!0);try{let e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(s)}&limit=5`),a=await e.json();g(a)}catch(e){console.error("Search failed:",e)}finally{p(!1)}}},k=e=>Math.round(Math.PI*e*e*.5),Z=async s=>{let a={id:Date.now().toString(),name:s.display_name?.split(",")[0]||s.name,lat:parseFloat(s.lat),lng:parseFloat(s.lon),radius:f,status:"downloading",progress:0,sizeMB:k(f)};b(e=>[a,...e]),e(a.lat,a.lng,a.name);let t=0,l=setInterval(()=>{if((t+=15*Math.random())>=100){if(t=100,clearInterval(l),b(e=>e.map(e=>e.id===a.id?{...e,status:"downloaded",progress:100}:e)),"indexedDB"in window){let e=indexedDB.open("offline-maps",1);e.onsuccess=e=>{e.target.result.transaction(["maps"],"readwrite").objectStore("maps").add({id:a.id,name:a.name,lat:a.lat,lng:a.lng,radius:a.radius,downloadedAt:new Date().toISOString(),sizeMB:a.sizeMB})},e.onupgradeneeded=e=>{let s=e.target.result;s.objectStoreNames.contains("maps")||s.createObjectStore("maps",{keyPath:"id"})}}}else b(e=>e.map(e=>e.id===a.id?{...e,progress:Math.round(t)}:e))},500)},B=e=>{b(s=>s.filter(s=>s.id!==e)),"indexedDB"in window&&(indexedDB.open("offline-maps",1).onsuccess=s=>{s.target.result.transaction(["maps"],"readwrite").objectStore("maps").delete(e)})};return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(h.Zb,{className:"border-white/50 bg-white/80 backdrop-blur-sm shadow-xl",children:[l.jsx(h.Ol,{children:(0,l.jsxs)(h.ll,{className:"flex items-center gap-2",children:[l.jsx(r.Z,{className:"w-5 h-5 text-blue-600"}),"Download Custom Area"]})}),(0,l.jsxs)(h.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex gap-2",children:[l.jsx("div",{className:"flex-1",children:l.jsx("input",{type:"text",value:s,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&S(),placeholder:"Search for a city, landmark, or address...",className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,l.jsxs)(m.z,{onClick:S,disabled:t||!s.trim(),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:[t?l.jsx(n.Z,{className:"w-4 h-4 animate-spin"}):l.jsx(r.Z,{className:"w-4 h-4"}),l.jsx("span",{className:"ml-2",children:"Search"})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[l.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Download Radius:"}),(0,l.jsxs)("select",{value:f,onChange:e=>N(parseInt(e.target.value)),className:"px-3 py-1.5 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:5,children:"5 km (~12 MB)"}),l.jsx("option",{value:10,children:"10 km (~50 MB)"}),l.jsx("option",{value:25,children:"25 km (~310 MB)"}),l.jsx("option",{value:50,children:"50 km (~1.2 GB)"}),l.jsx("option",{value:100,children:"100 km (~5 GB)"})]})]}),j.length>0&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Select a location:"}),j.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 hover:bg-slate-100 rounded-lg border border-slate-200 cursor-pointer transition",onClick:()=>{Z(e),g([]),a("")},children:[(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[l.jsx(d.Z,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"font-medium text-slate-900",children:e.display_name?.split(",")[0]}),l.jsx("p",{className:"text-xs text-slate-500",children:e.display_name}),(0,l.jsxs)("p",{className:"text-xs text-slate-400 mt-1",children:[parseFloat(e.lat).toFixed(4),", ",parseFloat(e.lon).toFixed(4)]})]})]}),(0,l.jsxs)(u.C,{variant:"info",className:"bg-blue-100 text-blue-700",children:["~",k(f)," MB"]})]},s))]}),t&&(0,l.jsxs)("div",{className:"text-center py-4",children:[l.jsx(n.Z,{className:"w-6 h-6 animate-spin mx-auto text-blue-600"}),l.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"Searching..."})]})]})]}),w.length>0&&(0,l.jsxs)(h.Zb,{className:"border-white/50 bg-white/80 backdrop-blur-sm shadow-xl",children:[l.jsx(h.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)(h.ll,{className:"flex items-center gap-2",children:[l.jsx(c.Z,{className:"w-5 h-5 text-green-600"}),"Downloaded Areas"]}),(0,l.jsxs)(u.C,{variant:"info",children:[w.length," areas"]})]})}),l.jsx(h.aY,{className:"space-y-3",children:w.map(e=>(0,l.jsxs)("div",{className:"p-4 bg-gradient-to-r from-white to-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`h-10 w-10 rounded-lg flex items-center justify-center ${"downloaded"===e.status?"bg-green-500 text-white":"downloading"===e.status?"bg-blue-500 text-white":"bg-slate-300 text-slate-600"}`,children:"downloaded"===e.status?l.jsx(o.Z,{className:"w-5 h-5"}):"downloading"===e.status?l.jsx(n.Z,{className:"w-5 h-5 animate-spin"}):l.jsx(d.Z,{className:"w-5 h-5"})}),(0,l.jsxs)("div",{children:[l.jsx("p",{className:"font-medium text-slate-900",children:e.name}),(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:[e.lat.toFixed(4),", ",e.lng.toFixed(4)," • ",e.radius," km radius"]})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(u.C,{variant:"downloaded"===e.status?"success":"info",className:"downloaded"===e.status?"bg-green-500 text-white":"bg-blue-500 text-white",children:[e.sizeMB," MB"]}),"downloaded"===e.status&&l.jsx("button",{onClick:()=>B(e.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:l.jsx(x.Z,{className:"w-4 h-4"})})]})]}),"downloading"===e.status&&(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsxs)("div",{className:"flex justify-between text-xs text-slate-600",children:[l.jsx("span",{children:"Downloading map tiles..."}),(0,l.jsxs)("span",{children:[e.progress,"%"]})]}),l.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-600 transition-all duration-300",style:{width:`${e.progress}%`}})})]}),"downloaded"===e.status&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-green-600 mt-2",children:[l.jsx(o.Z,{className:"w-3 h-3"}),l.jsx("span",{children:"Available offline • Click on map to view"})]})]},e.id))})]}),l.jsx(h.Zb,{className:"border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",children:l.jsx(h.aY,{className:"pt-4",children:(0,l.jsxs)("div",{className:"flex gap-3",children:[l.jsx("div",{className:"text-3xl",children:"\uD83D\uDCA1"}),(0,l.jsxs)("div",{className:"text-sm text-slate-700",children:[l.jsx("p",{className:"font-semibold mb-1",children:"How it works:"}),(0,l.jsxs)("ul",{className:"space-y-1 text-xs",children:[l.jsx("li",{children:"• Search for any location worldwide"}),l.jsx("li",{children:"• Select download radius (larger = more storage)"}),l.jsx("li",{children:"• Maps are cached in your browser for offline use"}),l.jsx("li",{children:"• Downloaded areas work without internet connection"}),l.jsx("li",{children:"• Storage is saved locally using IndexedDB"})]})]})]})})})]})}[m,h,u]=p.then?(await p)():p,t()}catch(e){t(e)}})}};