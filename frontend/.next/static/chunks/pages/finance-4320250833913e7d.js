(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[504],{3779:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/finance",function(){return s(5926)}])},5926:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var a=s(5893),l=s(7168),n=s(8453),r=s(3552),c=s(2336),x=s(1064),i=s(2417),d=s(6471),o=s(8701),p=s(7460),h=s.n(p),m=s(3162),u=s(7294);function j(){let e=(0,d.q)(e=>e.groups),{isLoading:t}=(0,o.RW)(),{data:s=[],isLoading:p}=(0,o.D0)(),j=(0,o.CB)(),y=(0,o.Ui)(),[N,g]=(0,u.useState)(!1),[f,v]=(0,u.useState)({title:"",amount:"",category:"food",currency:"USD"}),b=Object.values(e).flatMap(e=>e.expenses.map(t=>({group:e,expense:t,type:"group"}))),w=b.reduce((e,t)=>e+t.expense.amount,0),S=s.reduce((e,t)=>e+t.amount,0),C=async e=>{e.preventDefault();try{await j.mutateAsync({title:f.title,category:f.category,currency:f.currency,amount:parseFloat(f.amount),incurredOn:new Date().toISOString()}),v({title:"",amount:"",category:"food",currency:"USD"}),g(!1)}catch(e){alert("Failed to add expense")}};return(0,a.jsxs)(c.L,{title:"Finance",description:"Track personal and group expenses, outstanding balances, and export audit-ready reports.",actions:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(i.z,{onClick:()=>g(!N),variant:"primary",children:[(0,a.jsx)(n.Z,{className:"mr-2 h-4 w-4"})," Add Personal Expense"]}),(0,a.jsxs)(i.z,{onClick:()=>{let e=[...b.map(e=>{let{group:t,expense:s}=e;return{type:"Group",group:t.title,title:s.title,category:s.category,amount:s.amount,currency:s.currency,paidBy:s.paidBy,incurredOn:s.incurredOn}}),...s.map(e=>({type:"Personal",group:"-",title:e.title,category:e.category,amount:e.amount,currency:e.currency,paidBy:"You",incurredOn:e.incurredOn}))],t=h().unparse(e);(0,m.saveAs)(new Blob([t],{type:"text/csv;charset=utf-8;"}),"travel-finance-ledger.csv")},variant:"secondary",children:[(0,a.jsx)(r.Z,{className:"mr-2 h-4 w-4"})," Export all"]})]}),children:[N&&(0,a.jsxs)(x.Zb,{className:"mb-6",children:[(0,a.jsx)(x.Ol,{children:(0,a.jsx)(x.ll,{children:"Add Personal Expense"})}),(0,a.jsx)(x.aY,{children:(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Title",value:f.title,onChange:e=>v({...f,title:e.target.value}),className:"rounded-lg border border-slate-200 px-4 py-2 text-sm",required:!0}),(0,a.jsx)("input",{type:"number",step:"0.01",placeholder:"Amount",value:f.amount,onChange:e=>v({...f,amount:e.target.value}),className:"rounded-lg border border-slate-200 px-4 py-2 text-sm",required:!0}),(0,a.jsxs)("select",{value:f.category,onChange:e=>v({...f,category:e.target.value}),className:"rounded-lg border border-slate-200 px-4 py-2 text-sm",children:[(0,a.jsx)("option",{value:"food",children:"Food"}),(0,a.jsx)("option",{value:"accommodation",children:"Accommodation"}),(0,a.jsx)("option",{value:"transport",children:"Transport"}),(0,a.jsx)("option",{value:"activities",children:"Activities"}),(0,a.jsx)("option",{value:"gear",children:"Gear"}),(0,a.jsx)("option",{value:"other",children:"Other"})]}),(0,a.jsxs)("select",{value:f.currency,onChange:e=>v({...f,currency:e.target.value}),className:"rounded-lg border border-slate-200 px-4 py-2 text-sm",children:[(0,a.jsx)("option",{value:"USD",children:"USD"}),(0,a.jsx)("option",{value:"EUR",children:"EUR"}),(0,a.jsx)("option",{value:"GBP",children:"GBP"}),(0,a.jsx)("option",{value:"INR",children:"INR"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.z,{type:"submit",isLoading:j.isPending,children:"Add Expense"}),(0,a.jsx)(i.z,{type:"button",variant:"ghost",onClick:()=>g(!1),children:"Cancel"})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-4",children:[(0,a.jsx)(x.Zb,{children:(0,a.jsxs)(x.aY,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Group Expenses"}),(0,a.jsxs)("p",{className:"text-3xl font-semibold text-slate-900",children:["$",w.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[b.length," expenses across ",Object.keys(e).length," groups"]})]})}),(0,a.jsx)(x.Zb,{children:(0,a.jsxs)(x.aY,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Personal Expenses"}),(0,a.jsxs)("p",{className:"text-3xl font-semibold text-slate-900",children:["$",S.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[s.length," personal expenses"]})]})}),(0,a.jsx)(x.Zb,{children:(0,a.jsxs)(x.aY,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Spend"}),(0,a.jsxs)("p",{className:"text-3xl font-semibold text-primary-600",children:["$",(w+S).toLocaleString()]}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Group + Personal"})]})}),(0,a.jsx)(x.Zb,{children:(0,a.jsxs)(x.aY,{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Expenses"}),(0,a.jsx)("p",{className:"text-3xl font-semibold text-slate-900",children:b.length+s.length}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"All tracked expenses"})]})})]}),(0,a.jsxs)(x.Zb,{className:"mt-8",children:[(0,a.jsx)(x.Ol,{children:(0,a.jsx)(x.ll,{children:"Personal Expenses"})}),(0,a.jsx)(x.aY,{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[(0,a.jsx)("thead",{className:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Title"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Category"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Amount"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Currency"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-slate-100",children:[p&&0===s.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-slate-500",children:"Loading expenses..."})}),!p&&0===s.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No personal expenses yet. Add one above!"})}),s.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-3 text-slate-600",children:e.title}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:e.category}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-600",children:e.amount.toFixed(2)}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:e.currency}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:(0,l.WU)(new Date(e.incurredOn),"PP")}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>{confirm("Delete this expense?")&&y.mutate(e.id)},children:"Delete"})})]},e.id))]})]})})]}),(0,a.jsxs)(x.Zb,{className:"mt-8",children:[(0,a.jsx)(x.Ol,{children:(0,a.jsx)(x.ll,{children:"Group Expenses"})}),(0,a.jsx)(x.aY,{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[(0,a.jsx)("thead",{className:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Group"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Title"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Category"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Amount"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Currency"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"Date"})]})}),(0,a.jsxs)("tbody",{className:"divide-y divide-slate-100",children:[t&&0===b.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-slate-500",children:"Loading expenses..."})}),!t&&0===b.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-4 py-6 text-center text-sm text-slate-500",children:"No group expenses recorded yet."})}),b.map(e=>{let{group:t,expense:s}=e;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-3 text-slate-600",children:t.title}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-600",children:s.title}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:s.category}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-600",children:s.amount.toFixed(2)}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:s.currency}),(0,a.jsx)("td",{className:"px-4 py-3 text-slate-500",children:(0,l.WU)(new Date(s.incurredOn),"PP")})]},"group-".concat(s.id))})]})]})})]})]})}}},function(e){e.O(0,[664,40,803,168,22,542,152,888,774,179],function(){return e(e.s=3779)}),_N_E=e.O()}]);