(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736,152],{1742:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groups",function(){return r(9120)}])},1027:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var s=r(5893),n=r(801);let a={default:"bg-slate-100 text-slate-700",success:"bg-emerald-100 text-emerald-700",warning:"bg-amber-100 text-amber-700",danger:"bg-red-100 text-red-700",info:"bg-blue-100 text-blue-700"};function i(e){let{className:t,variant:r="default",...i}=e;return(0,s.jsx)("span",{className:(0,n.cn)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",a[r],t),...i})}},2417:function(e,t,r){"use strict";r.d(t,{z:function(){return o}});var s=r(5893),n=r(7294),a=r(801);let i={primary:"bg-primary-600 text-white hover:bg-primary-700",secondary:"border border-primary-600 text-primary-600 hover:bg-primary-50",subtle:"bg-slate-100 text-slate-700 hover:bg-slate-200",ghost:"text-slate-600 hover:bg-slate-100",danger:"bg-red-600 text-white hover:bg-red-700"},l={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-5 py-2.5 text-base"},o=n.forwardRef((e,t)=>{let{as:r="button",asChild:n,href:o,className:u,variant:d="primary",size:c="md",loadingText:p,isLoading:m,disabled:g,children:x,...y}=e,f=(0,a.cn)("inline-flex items-center justify-center rounded-md font-medium transition focus:outline-none focus:ring-2 focus:ring-primary-200 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-60",i[d],l[c],u),{form:h,formAction:b,formEncType:v,formMethod:j,formNoValidate:w,formTarget:N,type:D,value:C,...S}=y;return"a"===r?(0,s.jsx)("a",{ref:t,href:o,className:f,"aria-disabled":g||m,...S,children:m?null!=p?p:"Loading...":x}):(0,s.jsx)("button",{ref:t,disabled:g||m,className:f,...y,children:m?null!=p?p:"Loading...":x})});o.displayName="Button"},8701:function(e,t,r){"use strict";r.d(t,{xH:function(){return f},Qc:function(){return b},mm:function(){return x},CB:function(){return w},Ui:function(){return D},i4:function(){return j},hA:function(){return v},xR:function(){return g},RW:function(){return m},Iw:function(){return y},D0:function(){return N},er:function(){return h}});var s=r(3934),n=r(202),a=r(8029),i=r(8111),l=r(6471);let o=e=>{var t,r,s,n;return{id:e.user.id,email:e.user.email,phone:e.user.phone,photoUrl:null!==(t=e.user.photoUrl)&&void 0!==t?t:null,bloodGroup:null!==(r=e.user.bloodGroup)&&void 0!==r?r:null,emergencyContact:null!==(s=e.user.emergencyContact)&&void 0!==s?s:null,createdAt:e.joinedAt,role:null,displayName:null!==(n=e.displayName)&&void 0!==n?n:e.user.email,status:e.status}},u=(e,t)=>{var r;return{id:String(t.id),groupId:e,title:t.title,description:null!==(r=t.description)&&void 0!==r?r:void 0,category:t.category,currency:t.currency,amount:t.amount,splits:t.splits.map(e=>({memberId:e.memberId,amount:e.amount})),paidBy:t.paidBy.id,incurredOn:t.incurredOn,receiptUrl:void 0,attachments:[],createdAt:t.createdAt}},d=e=>{var t,r;return{id:String(e.id),ownerType:e.ownerType,ownerId:e.ownerId,groupId:"group"===e.ownerType?String(e.ownerId):void 0,title:e.title,description:null!==(t=e.description)&&void 0!==t?t:void 0,fileType:e.fileType,fileSize:e.fileSize,storageKey:e.storageKey,expiresAt:null!==(r=e.expiresAt)&&void 0!==r?r:void 0,createdAt:e.createdAt,createdBy:e.createdBy.id,isEncrypted:e.isEncrypted}},c=e=>{var t,r;return{id:String(e.id),code:e.code,expiresAt:null!==(t=e.expiresAt)&&void 0!==t?t:void 0,usageLimit:null!==(r=e.usageLimit)&&void 0!==r?r:void 0,usedCount:e.usedCount,createdAt:e.createdAt,createdBy:e.createdBy.id}},p=e=>{var t,r,s,n,a,i,l;let p=String(e.id),m=e.members.map(o),g=e.expenses.map(e=>u(p,e)),x=e.documents.map(d);return{id:p,title:e.title,description:null!==(t=e.description)&&void 0!==t?t:void 0,destination:e.destination,startDate:e.startDate,endDate:e.endDate,isPublic:e.isPublic,inviteCode:e.inviteCode,coverImage:null!==(r=e.coverImage)&&void 0!==r?r:void 0,guides:null!==(s=e.guides)&&void 0!==s?s:[],tags:null!==(n=e.tags)&&void 0!==n?n:[],createdAt:e.createdAt,updatedAt:e.updatedAt,admins:e.members.filter(e=>"admin"===e.role||"co-admin"===e.role).map(e=>e.user.id),financeSummary:{totalExpenses:e.financeSummary.totalExpenses,totalMembers:e.financeSummary.totalMembers,outstandingBalance:e.financeSummary.outstandingBalance},offlinePackages:null!==(a=e.offlinePackages)&&void 0!==a?a:[],members:m,documents:x,itinerary:null!==(i=e.itinerary)&&void 0!==i?i:[],emergencyContacts:null!==(l=e.emergencyContacts)&&void 0!==l?l:[],invites:e.invites.map(c),expenses:g}},m=()=>{let{authFetch:e}=(0,i.a)(),t=(0,l.q)(e=>e.setGroups);return(0,s.a)({queryKey:["groups"],queryFn:async()=>{let r=(await e("/groups")).map(p);return t(r),r},staleTime:3e4})},g=e=>{let{authFetch:t}=(0,i.a)(),r=(0,l.q)(e=>e.setGroup);return(0,s.a)({queryKey:["groups",e],enabled:!!e,queryFn:async()=>{let s=p(await t("/groups/".concat(e)));return r(s),s},staleTime:3e4})},x=()=>{let{authFetch:e}=(0,i.a)(),t=(0,l.q)(e=>e.setGroup),r=(0,n.NL)();return(0,a.D)({mutationFn:async t=>p(await e("/groups",{method:"POST",body:JSON.stringify(t)})),onSuccess:e=>{t(e),r.invalidateQueries({queryKey:["groups"]}),r.invalidateQueries({queryKey:["groups",e.id]})}})},y=e=>{let{authFetch:t}=(0,i.a)(),r=(0,n.NL)();return(0,a.D)({mutationFn:async r=>await t("/groups/".concat(e,"/invite"),{method:"POST",body:JSON.stringify(r)}),onSuccess:()=>{r.invalidateQueries({queryKey:["groups",e]}),r.invalidateQueries({queryKey:["groups"]})}})},f=e=>{let{authFetch:t}=(0,i.a)(),r=(0,n.NL)();return(0,a.D)({mutationFn:async r=>await t("/groups/".concat(e,"/members"),{method:"POST",body:JSON.stringify(r)}),onSuccess:()=>{r.invalidateQueries({queryKey:["groups",e]}),r.invalidateQueries({queryKey:["groups"]})}})},h=e=>{let{authFetch:t}=(0,i.a)(),r=(0,n.NL)();return(0,a.D)({mutationFn:async r=>(await t("/groups/".concat(e,"/members/").concat(r),{method:"DELETE"}),r),onSuccess:()=>{r.invalidateQueries({queryKey:["groups",e]}),r.invalidateQueries({queryKey:["groups"]})}})},b=e=>{let{authFetch:t}=(0,i.a)(),r=(0,n.NL)();return(0,a.D)({mutationFn:async r=>{if(!e)throw Error("Group id is required to create an expense");return t("/groups/".concat(e,"/expenses"),{method:"POST",body:JSON.stringify(r)})},onSuccess:(t,s,n)=>(e&&(r.invalidateQueries({queryKey:["groups",e]}),r.invalidateQueries({queryKey:["groups",e,"expenses"]}),r.invalidateQueries({queryKey:["groups",e,"balance"]}),r.invalidateQueries({queryKey:["groups"]})),n)})},v=e=>{let{authFetch:t}=(0,i.a)();return(0,s.a)({queryKey:["groups",e,"expenses"],enabled:!!e,queryFn:async()=>e?(await t("/groups/".concat(e,"/expenses"))).map(t=>u(e,t)):[],staleTime:15e3})},j=e=>{let{authFetch:t}=(0,i.a)();return(0,s.a)({queryKey:["groups",e,"balance"],enabled:!!e,queryFn:async()=>e?await t("/groups/".concat(e,"/balance")):null,staleTime:15e3})},w=()=>{let{authFetch:e}=(0,i.a)(),t=(0,n.NL)();return(0,a.D)({mutationFn:async t=>e("/expenses/personal",{method:"POST",body:JSON.stringify(t)}),onSuccess:()=>{t.invalidateQueries({queryKey:["personal-expenses"]})}})},N=()=>{let{authFetch:e}=(0,i.a)();return(0,s.a)({queryKey:["personal-expenses"],queryFn:async()=>await e("/expenses/personal"),staleTime:15e3})},D=()=>{let{authFetch:e}=(0,i.a)(),t=(0,n.NL)();return(0,a.D)({mutationFn:async t=>(await e("/expenses/personal/".concat(t),{method:"DELETE"}),t),onSuccess:()=>{t.invalidateQueries({queryKey:["personal-expenses"]})}})}},9120:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var s=r(5893),n=r(7294),a=r(1664),i=r.n(a),l=r(7168),o=r(2336),u=r(1064),d=r(2417),c=r(1027),p=r(6471),m=r(8701),g=r(801);let x=[{id:"all",label:"All"},{id:"upcoming",label:"Upcoming"},{id:"in-progress",label:"In progress"},{id:"completed",label:"Completed"},{id:"public",label:"Public"},{id:"private",label:"Private"}];function y(e){let t=new Date,r=new Date(e.startDate);return new Date(e.endDate)<t?"completed":r>t?"upcoming":"in-progress"}function f(){let e=(0,p.q)(e=>e.groups),{isLoading:t}=(0,m.RW)(),[r,a]=(0,n.useState)(""),[f,h]=(0,n.useState)("all");console.log("=== GROUPS PAGE ==="),console.log("All groups in store:",Object.values(e)),console.log("Groups object:",e);let b=(0,n.useMemo)(()=>Object.values(e).filter(e=>!!e.title.toLowerCase().includes(r.toLowerCase())&&("all"===f||("public"===f?e.isPublic:"private"===f?!e.isPublic:y(e)===f))),[f,e,r]);return(0,s.jsxs)(o.L,{title:"Groups & expeditions",description:"Create private or public trips, assign admins, and keep every traveler informed.",actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.z,{variant:"secondary",asChild:!0,children:(0,s.jsx)(i(),{href:"/groups/create",children:"New trip"})}),(0,s.jsx)(d.z,{variant:"ghost",asChild:!0,children:(0,s.jsx)(i(),{href:"/offline",children:"Offline kits"})})]}),children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 border-b border-slate-100 pb-6",children:[(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:x.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>h(e.id),className:(0,g.cn)("rounded-full px-4 py-2 text-sm font-medium transition shadow-md",f===e.id?"bg-gradient-to-r from-blue-600 to-purple-600 text-white scale-105":"bg-white/70 backdrop-blur-sm text-slate-600 hover:bg-white hover:scale-105"),children:e.label},e.id))}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,s.jsx)("input",{value:r,onChange:e=>a(e.target.value),placeholder:"Search by destination, invite code, or admin",className:"w-full rounded-lg border border-white/50 bg-white/70 backdrop-blur-sm px-4 py-2 text-sm text-slate-700 shadow-md focus:border-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-200 md:w-80"}),(0,s.jsxs)("div",{className:"flex gap-2 text-xs text-slate-500",children:[(0,s.jsx)(c.C,{variant:"info",children:"Offline ready"}),(0,s.jsxs)("span",{children:[Object.values(e).length," total groups"]})]})]})]}),(0,s.jsxs)("div",{className:"mt-6 grid gap-5 md:grid-cols-2 xl:grid-cols-3",children:[t&&0===Object.keys(e).length&&(0,s.jsx)(u.Zb,{className:"md:col-span-2 xl:col-span-3",children:(0,s.jsx)(u.aY,{children:(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Loading groups..."})})}),!t&&0===b.length&&(0,s.jsx)(u.Zb,{className:"md:col-span-2 xl:col-span-3",children:(0,s.jsxs)(u.aY,{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"No groups match your filters. Create a new itinerary or adjust the search to find existing trips."}),(0,s.jsx)(d.z,{variant:"secondary",asChild:!0,children:(0,s.jsx)(i(),{href:"/groups/create",children:"Launch your first trip"})})]})}),b.map(e=>{var t;let r=y(e),n=["from-blue-500 to-cyan-500","from-purple-500 to-pink-500","from-orange-500 to-red-500","from-green-500 to-teal-500","from-indigo-500 to-blue-500","from-pink-500 to-rose-500"],a=n[parseInt(e.id.toString())%n.length];return(0,s.jsxs)(u.Zb,{className:"border-0 shadow-lg hover:shadow-2xl transition-all hover:scale-[1.02] overflow-hidden bg-white/80 backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"h-2 bg-gradient-to-r ".concat(a)}),(0,s.jsxs)(u.aY,{className:"space-y-3 pt-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br ".concat(a," flex items-center justify-center text-white text-xl shadow-lg"),children:"completed"===r?"✓":"upcoming"===r?"\uD83D\uDCC5":"✈️"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-base font-bold text-slate-900",children:e.title}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:["\uD83D\uDCCD ",e.destination]})]})]}),(0,s.jsx)(c.C,{variant:"completed"===r?"default":"upcoming"===r?"info":"success",children:r.replace("-"," ")})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:null!==(t=e.description)&&void 0!==t?t:"No description provided"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1 text-slate-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"\uD83D\uDD11"})," ",e.inviteCode]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-slate-600",children:[(0,s.jsx)("span",{className:"font-medium",children:e.isPublic?"\uD83C\uDF0D":"\uD83D\uDD12"}),e.isPublic?"Public":"Private"]}),(0,s.jsxs)("div",{className:"col-span-2 text-slate-500 text-xs",children:["\uD83D\uDCC6 ",(0,l.WU)(new Date(e.startDate),"PP")," - ",(0,l.WU)(new Date(e.endDate),"PP")]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-slate-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"\uD83D\uDC65"})," ",e.members.length," travelers"]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 text-slate-600 font-semibold",children:[(0,s.jsx)("span",{className:"font-medium",children:"\uD83D\uDCB0"})," $",e.financeSummary.totalExpenses.toLocaleString()]})]}),(0,s.jsx)("div",{className:"flex items-center justify-end pt-2",children:(0,s.jsx)(d.z,{variant:"secondary",size:"sm",asChild:!0,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-lg",children:(0,s.jsx)(i(),{href:"/groups/".concat(e.id),children:"Open Trip →"})})})]})]},e.id)})]})]})}}},function(e){e.O(0,[664,40,803,168,542,888,774,179],function(){return e(e.s=1742)}),_N_E=e.O()}]);